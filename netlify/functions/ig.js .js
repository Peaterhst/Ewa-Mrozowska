export async function handler(){const p='ewamrozowska.makeup',u=`https://www.instagram.com/${p}/`;try{const r=await fetch(u,{headers:{'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124 Safari/537.36','Accept-Language':'pl-PL,pl;q=0.9,en;q=0.8'}});const h=await r.text(),m=h.match(/"edge_owner_to_timeline_media":\s*\{.+?"edges":\s*(\[\{.+?\}\])\s*\}/s),er=m?m[1]:'[]',urls=[...h.matchAll(/"display_url":"(https:[^"]+?)"/g)].map(a=>decodeURIComponent(a[1].replace(/\\u0026/g,'&'))),codes=[...h.matchAll(/"shortcode":"([^"]+?)"/g)].map(a=>a[1]);let e=[];try{e=JSON.parse(er)}catch{}const out=[];if(Array.isArray(e)&&e.length){e.forEach(x=>{const n=x.node||x;if(n.display_url&&n.shortcode){out.push({url:n.display_url,thumb:n.display_url,permalink:`https://www.instagram.com/p/${n.shortcode}/`,alt:(n.accessibility_caption||'').slice(0,80)});}});}if(!out.length&&urls.length){for(let i=0;i<Math.min(urls.length,12);i++){const img=urls[i],sc=codes[i]||'';out.push({url:img,thumb:img,permalink:sc?`https://www.instagram.com/p/${sc}/`:`https://www.instagram.com/${p}/`,alt:'Instagram post'});}}return{statusCode:200,headers:{'Access-Control-Allow-Origin':'*','Cache-Control':'public, max-age=900'},body:JSON.stringify(out.slice(0,12))}}catch{return{statusCode:200,headers:{'Access-Control-Allow-Origin':'*'},body:'[]'}}}
